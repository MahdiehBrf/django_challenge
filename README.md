# django_challenge
با سلام

این پروژه یک چالش برای سنجیدن سطح تسلط شما در جنگو است.

# **توضیح دامنه‌ی پروژه**

در این پروژه هر کاربر می‌تواند تعدادی پست بنویسد، که هر کدام از این پست‌ها می‌تواند شامل چندین فرم باشند. این فرم‌ها به صورت داینامیک تولید می‌شوند. به صورتی که در هنگام ساخت فرم، سوالات آن و فرمت جواب از کاربر پرسیده می‌شود.

همچنین هر کاربر می‌تواند پست‌ها را مشاهده کند و به هر فرمی که می‌خواهد، پاسخ بدهد.

ناشر پست، در هنگام ساخت فرم باید مشخص کند که هر چند ساعت یکبار می‌خواهد گزارشی از پاسخ‌های آن دریافت نماید. اما از آنجایی که هر کاربر می‌تواند چندین پست داشته باشد و هر پست می‌تواند چندین فرم داشته باشد، ممکن است تعداد پیامک‌های دریافتی برای هر کاربر  زیاد شود و باعث آزارش شود. به همین دلیل کاربر انتظار دارد پیامک‌ها به صورت جمع‌بندی‌شده (aggregated) برایش ارسال شود. به طور مثال یکی از متن‌های پیامک می‌تواند به صورت زیر باشد:

       سلام مهدیه‌ گرامی
       در سه ساعت گذشته، ۵ پاسخ برای فرم سایت یا اینستا؟، ۲ پاسخ برای فرم درخواست نمایندگی و یک پاسخ برای فرم سفارش کوله ثبت شده است.
       
       برای مشاهده‌ی پاسخ‌ها می‌توانید به آدرس زیر مراجعه کنید.
       test.ir/forms/
#  **توضیح چالش**
در این چالش باید ۶ قسمت و نیازمندی پروژه‌ی توصیف شده را کامل کنید:

۱. نیازمندی اول ارسال پیامک جمع‌بندی شده از پاسخ فرم‌ها است. (برای اینکه درک از مسئله راحت شود، بخش‌هایی از کد زده شده است. اما در صورتی که راه دیگری مد نظر دارید که به همین توصیف از مسئله منجرب می‌شود و از لحاظ پرفورمنس مشکلی ایجاد نمی‌کند، می‌توانید از راه‌های دیگر نیز استفاده نمایید.)

در این روش، تسکی نوشته شده است (با استفاده از کتابخانه‌ی celery) که باید هرچند وقت یکبار اجرا شود و فرم‌هایی که در این مدت پاسخی داشته اند را یافته و پیامک ارسال نماید.

در این تسک شما باید مپی از پست‌ها و اطلاعات فرم‌های اخیر پیدا نمایید و همچنین متناسب با آن نحوه‌ی ساخت متن پیامک را کامل نمایید.

۲. لازم است تابع notify_author تا جای ممکن ریفکتور شود.

۳. برای کاربر فیلدی به نام PhoneField تعریف شده است. لازم است برای این فیلد چندین validation اضافه شود تا از صحت استرینگ داده شده به عنوان شماره موبایل، قبل از ذخیره‌سازی، اطمینان حاصل شود. همچنین لازم است همه‌ی شماره‌ موبایل‌ها به صورت یکسان ذخیره شوند به صورتی که همه با کد کشور (ثابت +۹۸) شروع شوند.

۴. لازم است در فایل api.py، ویوست‌های لازم برای ساخت، ویرایش و مشاهده‌ی پست‌ها و فرم‌ها نوشته شود. توجه شود که لازم است روت ها به صورت زیر باشند:

POST & GET /posts/{post_id}/forms/

PATCH & GET /posts/{post_id}/forms/{form_id}/

۵. همچنین لازم است apiای برای ساخت گروهی پست‌ها به همراه اطلاعات فرم‌های آن‌ها داده شود. برای مثال:

PATCH /posts/bulk_create/

request body:

    posts = [
    {
        "title": "test",
        "forms": {
            "title": "درخواست نمایندگی",
            "inputs": [
                {
                    "label": "شهر",
                    "type": "choice",
                    "choices": ["تهران", "مشهد", "تبریز"]
                }
            ],
            "extra_data": {
                "time_interval": 180
            }
        }
    },
    {
        "title": "test",
        "forms": {
            "title": "سفارش کوله",
            "inputs": [
                {
                    "label": "نام و نام خانوادگی",
                    "type": "string",
                }
            ],
            "extra_data": {
                "time_interval": 60
            }
        }
    }
    ]
